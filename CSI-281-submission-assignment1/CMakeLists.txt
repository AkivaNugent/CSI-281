# A draft of this file was generated by ChatGPT 4o and Modified by David Kopec
# Minimum CMake version required
cmake_minimum_required(VERSION 3.10)

# Enable testing for CTest
enable_testing()

# Project name (change for each assignment)
project(assignment1)

# Set the C++ standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED True)

# Set the warning level
if (MSVC)
    add_compile_options(/W4)
else()
    add_compile_options(-Wall -Wextra -Wpedantic)
endif()

# Specify the source directories
set(SRC_DIR ${CMAKE_SOURCE_DIR}/src)
set(LIB_DIR ${CMAKE_SOURCE_DIR}/lib)

# Include directories
include_directories(${LIB_DIR})

# Collect all source files from the src and lib directories
file(GLOB_RECURSE SRC_FILES ${SRC_DIR}/*.cpp)
file(GLOB_RECURSE LIB_FILES ${LIB_DIR}/*.cpp)

# Add the executable target
add_executable(${PROJECT_NAME} ${SRC_FILES} ${LIB_FILES})

# Add a test that can be run with ctest
add_test(NAME ${PROJECT_NAME} COMMAND ${PROJECT_NAME})

# Copy the data file to the build directory
if(EXISTS ${CMAKE_SOURCE_DIR}/tempdata.csv)
    message(STATUS "Copying tempdata.csv from ${CMAKE_SOURCE_DIR} to ${CMAKE_BINARY_DIR}")
    configure_file(${CMAKE_SOURCE_DIR}/tempdata.csv ${CMAKE_BINARY_DIR}/tempdata.csv COPYONLY)
    add_custom_command(
            TARGET ${PROJECT_NAME} PRE_BUILD
            COMMAND ${CMAKE_COMMAND} -E copy
            ${CMAKE_BINARY_DIR}/tempdata.csv
            $<TARGET_FILE_DIR:${PROJECT_NAME}>
    )
endif()

# Print message when building
message(STATUS "Building ${PROJECT_NAME} with sources from ${SRC_DIR} and ${LIB_DIR}")
